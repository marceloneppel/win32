<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no">
  <meta name="generator" content="made with love by dartdoc 0.39.0">
  <meta name="description" content="win32 API docs, for the Dart programming language.">
  <title>win32 - Dart API docs</title>

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,300;0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="static-assets/github.css">
  <link rel="stylesheet" href="static-assets/styles.css">
  <link rel="icon" href="static-assets/favicon.png">

</head>

<body data-base-href=""
      data-using-base-href="false">

<div id="overlay-under-drawer"></div>

<header id="title">
  <button id="sidenav-left-toggle" type="button">&nbsp;</button>
  <ol class="breadcrumbs gt-separated dark hidden-xs">
    <li><a href="https://win32.pub">win32 package</a></li>
  </ol>
  <div class="self-name">win32</div>
  <form class="search navbar-right" role="search">
    <input type="text" id="search-box" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
</header>

<main>

  <div id="dartdoc-sidebar-left" class="sidebar sidebar-offcanvas-left">
    <header id="header-search-sidebar" class="hidden-l">
      <form class="search-sidebar" role="search">
        <input type="text" id="search-sidebar" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
      </form>
    </header>
    
    <ol class="breadcrumbs gt-separated dark hidden-l" id="sidebar-nav">
      <li><a href="https://win32.pub">win32 package</a></li>
    </ol>
    
    <h5 class="hidden-xs"><span class="package-name">win32</span> <span class="package-kind">package</span></h5>
    <ol>
          <li class="section-title">Topics</li>
            <li><a href="topics/advapi32-topic.html">advapi32</a></li>
            <li><a href="topics/bthprops-topic.html">bthprops</a></li>
            <li><a href="topics/com-topic.html">com</a></li>
            <li><a href="topics/comctl32-topic.html">comctl32</a></li>
            <li><a href="topics/comdlg32-topic.html">comdlg32</a></li>
            <li><a href="topics/dxva2-topic.html">dxva2</a></li>
            <li><a href="topics/gdi32-topic.html">gdi32</a></li>
            <li><a href="topics/kernel32-topic.html">kernel32</a></li>
            <li><a href="topics/ole32-topic.html">ole32</a></li>
            <li><a href="topics/oleaut32-topic.html">oleaut32</a></li>
            <li><a href="topics/powrprof-topic.html">powrprof</a></li>
            <li><a href="topics/psapi-topic.html">psapi</a></li>
            <li><a href="topics/shcore-topic.html">shcore</a></li>
            <li><a href="topics/shell32-topic.html">shell32</a></li>
            <li><a href="topics/user32-topic.html">user32</a></li>
            <li><a href="topics/version-topic.html">version</a></li>
            <li><a href="topics/winmm-topic.html">winmm</a></li>
            <li><a href="topics/winrt-topic.html">winrt</a></li>
          <li class="section-title">Libraries</li>
          <li><a href="win32/win32-library.html">win32</a></li>
    </ol>
  </div>

  <div id="dartdoc-main-content" class="main-content">
      <section class="desc markdown">
        <p><img src="https://github.com/timsneath/win32/blob/main/doc/images/win32.png?raw=true" alt="Dart/Win32"></p>
<p>A package that wraps some of the most common Win32 API calls using FFI to make
them accessible to Dart code without requiring a C compiler or the Windows SDK.</p>
<p><a href="https://pub.dev/packages/win32"><img src="https://img.shields.io/pub/v/win32.svg" alt="pub package"></a>
<a href="https://dart.dev"><img src="https://img.shields.io/badge/language-Dart-blue.svg" alt="Language"></a>
<img src="https://github.com/timsneath/win32/workflows/Dart/badge.svg" alt="Dart"></p>
<p><strong>IMPORTANT: If you are using Flutter 1.22 or earlier, use
<a href="https://pub.dev/packages/win32/versions/1.7.4+1">v1.7.4</a> of this package. Later versions of Dart include changes to FFI that are incompatible with older versions, and <code>win32</code> 2.x works with the updated API.</strong></p>
<p>Perhaps of as much use as the APIs themselves, this package provides a variety
of instructive examples for more complex FFI usage scenarios.</p>
<p>By design, this package provides minimal modifications to the Win32 API to
support Dart idioms. The goal is to provide high familiarity to an existing
Win32 developer. Other plugins may build on these primitives to provide a
friendly API for Dart and Flutter developers. A good example of that is
<a href="https://pub.dev/packages/filepicker_windows">filepicker_windows</a>, which offers
a common item dialog suitable for incorporation into an existing Flutter app.</p>
<h2 id="usage">Usage</h2>
<p>This package lets you write apps that use the Windows API directly from Dart, by
wrapping common Win32, COM and Windows Runtime APIs using Dart FFI.</p>
<p>You could use it to call a Win32 API like
<a href="https://docs.microsoft.com/en-us/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesexw">EnumFontFamiliesEx</a>
to enumerate all locally-installed fonts:</p>
<p><img src="https://github.com/timsneath/win32/blob/main/doc/images/fonts.png?raw=true" alt="Fonts screenshot"></p>
<p>or access system information that is not exposed directly by the Dart framework
libraries:</p>
<p><img src="https://github.com/timsneath/win32/blob/main/doc/images/power.png?raw=true" alt="System information screenshot"></p>
<p>You could use it to build a Windows app with Flutter that relies on Win32 APIs:</p>
<p><img src="https://github.com/timsneath/win32/blob/main/doc/images/disk_explorer.png?raw=true" alt="Disk explorer screenshot"></p>
<p>You could even use it to build a traditional Win32 app, written purely in Dart,
that could have come straight out of a classic Charles Petzold book on
programming Windows apps:</p>
<p><img src="https://github.com/timsneath/win32/blob/main/doc/images/notepad.png?raw=true" alt="Dart notepad screenshot"></p>
<p>or even, perhaps, a fully-fledged game using GDI:</p>
<p><img src="https://github.com/timsneath/win32/blob/main/doc/images/tetris.png?raw=true" alt="Dart Tetris for Win32 screenshot"></p>
<p>You might even build a package that depends upon it, like
<a href="https://pub.dev/packages/dart_console">dart_console</a>, which enables advanced
console manipulation:</p>
<p><img src="https://github.com/timsneath/win32/blob/main/doc/images/console.png?raw=true" alt="Dart console ANSI color demo screenshot"></p>
<p>or <a href="https://pub.dev/packages/filepicker_windows">filepicker_windows</a>, which
provides a modern Windows file picker for Flutter:</p>
<p><img src="https://github.com/timsneath/win32/blob/main/doc/images/filepicker.png?raw=true" alt="Windows file picker screenshot"></p>
<h2 id="getting-started">Getting started</h2>
<p>Many more samples can be found in the <code>example\</code> subdirectory, along with a test
suite in the <code>test\</code> subdirectory that shows other API calls.</p>
<p>A good starting point is <code>hello.dart</code>. This example demonstrates creating a
Win32 window and responding to common messages such as <code>WM_PAINT</code> through a
<code>WindowProc</code> callback function.</p>
<p>To run it, type:</p>
<pre class="language-cmd"><code class="language-cmd">dart example\hello.dart
</code></pre>
<p>This should display a window with a text message.</p>
<p>This can be compiled into a standalone Win32 executable by running:</p>
<pre class="language-cmd"><code class="language-cmd">dart compile exe example\hello.dart -o example\bin\hello.exe
</code></pre>
<h2 id="samples">Samples</h2>
<h3 id="dart-samples">Dart samples</h3>
<p>The package includes a number of examples in the <code>example</code> subdirectory. These
examples use the Win32 API for all UI display and do not require Flutter.</p>
<table><thead><tr><th>Example</th><th>Description</th></tr></thead><tbody><tr><td><code>hello.dart</code></td><td>Basic Petzoldian "hello world" Win32 app</td></tr><tr><td><code>calendar.dart</code></td><td>Gets information about the calendar from a WinRT API</td></tr><tr><td><code>console.dart</code></td><td>Shows usage of console APIs</td></tr><tr><td><code>credentials.dart</code></td><td>Adds a credential to the store and retrieves it</td></tr><tr><td><code>devices.dart</code></td><td>Uses volume management APIs to list all disk devices</td></tr><tr><td><code>dialog.dart</code></td><td>Create a custom dialog box in code</td></tr><tr><td><code>dialogshow.dart</code></td><td>Creates a common item dialog (file picker) using COM</td></tr><tr><td><code>dynamic_load.dart</code></td><td>Demonstrate loading a DLL and calling it at runtime</td></tr><tr><td><code>filever.dart</code></td><td>Getting file version information from the file resource</td></tr><tr><td><code>guid.dart</code></td><td>Creates a globally unique identifier (GUID)</td></tr><tr><td><code>knownfolder.dart</code></td><td>Retrieves known folders from the current user profile</td></tr><tr><td><code>manifest\</code></td><td>Demonstrates the use of app manifests for compiled apps</td></tr><tr><td><code>modules.dart</code></td><td>Enumerates all loaded modules on the current system</td></tr><tr><td><code>monitor.dart</code></td><td>Uses DDC and monitor-config API to get monitor caps</td></tr><tr><td><code>msgbox.dart</code></td><td>Demonstrates a MessageBox from the console</td></tr><tr><td><code>notepad\notepad.dart</code></td><td>Lightweight replica of the Windows notepad applet</td></tr><tr><td><code>paint.dart</code></td><td>Demonstrates simple GDI drawing and min/max window sizing</td></tr><tr><td><code>play_sound.dart</code></td><td>Plays a WAV file through the Windows PlaySound API</td></tr><tr><td><code>screenshot.dart</code></td><td>Takes a screenshot of the current desktop</td></tr><tr><td><code>scroll.dart</code></td><td>Example of horizontal and vertical scrolling text window</td></tr><tr><td><code>sendinput.dart</code></td><td>Sends keyboard and mouse input to another window</td></tr><tr><td><code>snake.dart</code></td><td>Snake game using various GDI features</td></tr><tr><td><code>sysinfo.dart</code></td><td>Examples of getting device information from native C APIs</td></tr><tr><td><code>tetris\main.dart</code></td><td>Port of an open-source Tetris game to Dart</td></tr><tr><td><code>wallpaper.dart</code></td><td>Shows what wallpaper and background color are set</td></tr><tr><td><code>window.dart</code></td><td>Enumerates open windows and basic window manipulation</td></tr><tr><td><code>winmd.dart</code></td><td>Interrogate Windows Runtime types</td></tr><tr><td><code>wmi.dart</code></td><td>Using WMI from COM to retrieve device/OS information</td></tr></tbody></table>
<h3 id="flutter-samples">Flutter samples</h3>
<p>The <code>explorer\</code> subdirectory contains an example of a simple Flutter app that
uses the volume management Win32 APIs to find the disk drives connected to your
computer and their volume IDs and attached paths.</p>
<h2 id="requirements">Requirements</h2>
<p>This package assumes the <a href="https://dart.dev/get-dart">Dart 64-bit compiler</a>,
running on Windows. Most commands are tested on 32-bit Windows, but due to the
lack of a compiler for 32-bit executables and the increasing lack of machines
running 32-bit OSes, this is inevitably a low priority. The package is also
tested on Windows-on-ARM architecture, running in x64 emulation mode.</p>
<h2 id="features-and-bugs">Features and bugs</h2>
<p>Let me know what APIs you're interested in seeing. I'm not planning to project
the entire Windows API, but I'm particularly interested in examples that either
unblock a plugin for Windows or that demonstrate more complex Windows APIs that
represent an important pattern.</p>
<p>Please file feature requests and bugs at the <a href="https://github.com/timsneath/win32">issue tracker</a>. This
is a hobby project, and should not be viewed as having the same level of
quality assurance as an official package from the Dart team. I'm a product
manager having fun on my weekends!</p>
<h2 id="backwards-compatibility">Backwards compatibility</h2>
<p>The library version uses a loose semver model, but you should not assume a
strict guarantee of no breaking changes between minor versions. That guarantee
is not possible to make, for several reasons:</p>
<ul>
<li>The underlying FFI library has not yet reached v1.0 and breaking changes at
that level may be difficult to encapsulate.</li>
<li>Several times, my fixing a bug in the fidelity of the Win32 API has tightened
the constraints over a parameter (for example, <code>Pointer</code> becomes
<code>Pointer&lt;INPUT&gt;</code>). These changes should be signalled in the log.</li>
<li>Adding new features may itself cause a breaking change. For example, if you
declare a missing Windows constant in your own code that is then added, Dart
will complain about the duplicate definition.</li>
</ul>
<p>One solution is to pin to a specific version of Win32, or declare a more
tightly-bounded version dependency (e.g. <code>'&gt;=1.7.0 &lt;1.8.0'</code> rather than merely
<code>^1.7.0</code>). But the best approach is simply to test regularly with the latest
version of this package, and continue to move your minimum forward. As the
package matures, these issues should gradually fade into the distance.</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>The Tetris example listed above is a fuller worked example of a reasonably
complete program that uses the Dart Win32 package. It is a port of a C version
of the game by Chang-Hung Liang. <a href="tetris/README.md">More information...</a></p>
<p>The <a href="https://github.com/davidejones/winsnake">C implementation of Snake</a> is by
David Jones, and is ported with his permission.</p>
<p>The original C version of the Notepad example was authored by Charles Petzold,
and is kindly <a href="https://www.charlespetzold.com/faq.html">licensed by him</a> without
restriction.</p>
<p>The summary Win32 API documentation comments are <a href="https://github.com/MicrosoftDocs/win32/blob/7b49862e8d58cfad5d4e5e22104c9fca7fd6db2f/ThirdPartyNotices">licensed by Microsoft</a> under
the <a href="https://github.com/MicrosoftDocs/win32/blob/7b49862e8d58cfad5d4e5e22104c9fca7fd6db2f/LICENSE">Creative Commons Attribution 4.0 International Public License</a>.</p>
      </section>
      
      <section class="summary">
          <h2>Libraries</h2>
        <dl>
          <dt id="win32">
            <span class="name"><a href="win32/win32-library.html">win32</a></span>           
          </dt>
          <dd>
            Support for programming against the Win32 API on Windows operating systems. <a href="win32/win32-library.html">[...]</a>
          </dd>
        </dl>
      </section>

  </div> <!-- /.main-content -->

  <div id="dartdoc-sidebar-right" class="sidebar sidebar-offcanvas-right">
  </div>

</main>

<footer>
  <span class="no-break">
    win32
      2.0.0
  </span>

</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="static-assets/typeahead.bundle.min.js"></script>
<script src="static-assets/highlight.pack.js"></script>
<script src="static-assets/script.js"></script>


</body>

</html>
